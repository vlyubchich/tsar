<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>6&nbsp; Generalized Autoregressive Conditional Heteroskedasticity (GARCH) Models â€“ Time Series Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./l07_trendtest.html" rel="next">
<link href="./l05_arima.html" rel="prev">
<link href="./tsar_fav.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-70a47bd5681a7291082a5b9f83d58762.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./l06_garch.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Generalized Autoregressive Conditional Heteroskedasticity (GARCH) Models</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Time Series Analysis</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/vlyubchich/tsar/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./l01_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Review of Linear Regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./l02_tsintro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction to Time Series Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./l03_smoothing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Smoothing, Detrending, and Deseasonalizing</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./l04_arma.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Autoregressive Moving Average (ARMA) Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./l05_arima.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Autoregressive Integrated Moving Average (ARIMA) Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./l06_garch.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Generalized Autoregressive Conditional Heteroskedasticity (GARCH) Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./l07_trendtest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Trend Detection</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./l08_tsreg1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Time Series Regression with Trends</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./l09_tsreg2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Time Series Regression with Correlated Errors</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./l12_forecast.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Model Evaluation and Forecasting</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./l13_spectral.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Spectral Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./software.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Software</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./s1_wls.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Weighted least squares</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./s2_gls.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Generalized least squares</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./s4_trendsync.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Synchrony of parametric trends</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./s7_garma.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Generalized autoregressive moving average (GARMA) models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./s_practice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Practice exercises</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">6.1</span> Introduction</a></li>
  <li><a href="#features-of-arch" id="toc-features-of-arch" class="nav-link" data-scroll-target="#features-of-arch"><span class="header-section-number">6.2</span> Features of ARCH</a></li>
  <li>
<a href="#models" id="toc-models" class="nav-link" data-scroll-target="#models"><span class="header-section-number">6.3</span> Models</a>
  <ul class="collapse">
<li><a href="#lagrange-multiplier-test" id="toc-lagrange-multiplier-test" class="nav-link" data-scroll-target="#lagrange-multiplier-test"><span class="header-section-number">6.3.1</span> Lagrange multiplier test</a></li>
  </ul>
</li>
  <li><a href="#extensions" id="toc-extensions" class="nav-link" data-scroll-target="#extensions"><span class="header-section-number">6.4</span> Extensions</a></li>
  <li><a href="#model-building" id="toc-model-building" class="nav-link" data-scroll-target="#model-building"><span class="header-section-number">6.5</span> Model building</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">6.6</span> Conclusion</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/vlyubchich/tsar/edit/master/l06_garch.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/vlyubchich/tsar/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-GARCH" class="quarto-section-identifier"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Generalized Autoregressive Conditional Heteroskedasticity (GARCH) Models</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p>The goal of this lecture is to introduce a class of models with conditional heteroskedasticity for stationary time series. You will be able to recognize the presence of such heteroskedasticity from graphs or statistical tests and model it.</p>
<p><strong>Objectives</strong></p>
<ol type="1">
<li>List features of ARCH recognizable from plots.</li>
<li>Diagnose ARCH effects using a statistical test.</li>
<li>Define ARCH(<span class="math inline">\(p\)</span>) and GARCH(<span class="math inline">\(p, q\)</span>) models and identify the orders <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span>.</li>
<li>Estimate the models and generate forecasts.</li>
<li>Discuss further extensions of the models.</li>
</ol>
<p><strong>Reading materials</strong></p>
<ul>
<li>Chapter 7 in <span class="citation" data-cites="Kirchgassner:Wolters:2007">KirchgÃ¤ssner and Wolters (<a href="references.html#ref-Kirchgassner:Wolters:2007" role="doc-biblioref">2007</a>)</span>
</li>
</ul>
<section id="introduction" class="level2" data-number="6.1"><h2 data-number="6.1" class="anchored" data-anchor-id="introduction">
<span class="header-section-number">6.1</span> Introduction</h2>
<p>In contrast to the traditional time series analysis that focuses on modeling the conditional first moment, models of <em>autoregressive conditional heteroskedasticity</em> (ARCH) and <em>generalized autoregressive conditional heteroskedasticity</em> (GARCH) specifically take the dependency of the conditional second moment into modeling consideration and accommodate the increasingly important need to explain and model risk and uncertainty in, for example, financial time series.</p>
<p>The ARCH models were introduced in 1982 by Robert Engle to model varying (conditional) variance or volatility of time series. It is often found in economics that the larger values of time series also lead to larger instability (i.e., larger variances), which is termed <em>(conditional) heteroskedasticity</em>. Standard examples for demonstrating ARCH or GARCH effects are time series of stock prices, interest and foreign exchange rates, and even some environmental processes: high-frequency data on wind speed, energy production, air quality, etc. <span class="citation" data-cites="Cripps:Dunsmuir:2003 Marinova:McAleer:2003 Taylor:Buizza:2004 Campbell:Diebold:2005">(see examples in <a href="references.html#ref-Cripps:Dunsmuir:2003" role="doc-biblioref">Cripps and Dunsmuir 2003</a>; <a href="references.html#ref-Marinova:McAleer:2003" role="doc-biblioref">Marinova and McAleer 2003</a>; <a href="references.html#ref-Taylor:Buizza:2004" role="doc-biblioref">Taylor and Buizza 2004</a>; <a href="references.html#ref-Campbell:Diebold:2005" role="doc-biblioref">Campbell and Diebold 2005</a>)</span>. In 2003, <a href="https://www.nobelprize.org/prizes/economic-sciences/2003/engle/facts/">Robert F. Engle was awarded 1/2 of the Sveriges Riksbank Prize in Economic Sciences in Memory of Alfred Nobel</a> for his work on ARCH models (the other half was awarded to C. Granger, see <a href="l08_tsreg1.html#sec-cointegration" class="quarto-xref"><span>Section 8.3</span></a>). Although it is not one of the prizes that Alfred Nobel established in his will in 1895, the Sveriges Riksbank Prize is referred to along with the other Nobel Prizes by the Nobel Foundation.</p>
</section><section id="features-of-arch" class="level2" data-number="6.2"><h2 data-number="6.2" class="anchored" data-anchor-id="features-of-arch">
<span class="header-section-number">6.2</span> Features of ARCH</h2>
<p>Since financial data typically have the autocorrelation coefficient close to 1 at lag 1 (e.g., the exchange rate between the US and Canadian dollar hardly changes from today to tomorrow), it is much more interesting and also more practically relevant to model the returns of a financial time series rather than the series itself. Let <span class="math inline">\(Y_t\)</span> be a time series of stock prices. The returns <span class="math inline">\(X_t\)</span> measure the relative changes in price and are typically defined as simple returns <span id="eq-returnsimple"><span class="math display">\[
X_t = \frac{Y_t - Y_{t-1}}{ Y_{t-1} } = \frac{Y_t}{ Y_{t-1} } - 1
\tag{6.1}\]</span></span> or logarithmic returns <span id="eq-returnlog"><span class="math display">\[
X_t = \ln Y_t - \ln Y_{t-1}.
\tag{6.2}\]</span></span> The two forms are approximately the same, since <span id="eq-return2"><span class="math display">\[
\begin{split}
\ln Y_t - \ln Y_{t-1} &amp;= \ln \left(\frac{Y_{t}}{Y_{t-1}} \right) \\
&amp;= \ln \left(\frac{Y_{t-1} + Y_{t} - Y_{t-1}}{Y_{t-1}} \right) \\
&amp;= \ln \left(1 + \frac{Y_{t} - Y_{t-1}}{Y_{t-1}} \right) \\
&amp;\approx \frac{ Y_{t} - Y_{t-1}}{ Y_{t -1} }.
\end{split}
\tag{6.3}\]</span></span> The approximation <span class="math inline">\(\ln(1+x) \approx x\)</span> works when <span class="math inline">\(x\)</span> is close to zero, which is true for many real-world financial problems. However, logarithmic returns are often preferred because in many applications their distribution is closer to normal compared to one of simple returns. Also, log returns have infinite support (from <span class="math inline">\(-\infty\)</span> to <span class="math inline">\(+\infty\)</span>) compared to simple returns that have a lower bound of <span class="math inline">\(-1\)</span>.</p>
<p>For an example calculation of log returns, see <a href="#fig-CAD" class="quarto-xref">Figure&nbsp;<span>6.1</span></a>.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Load data and calculate log returns</span></span>
<span><span class="va">CAD</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"data/CAD.csv"</span>,</span>
<span>                       na <span class="op">=</span> <span class="st">"Bank holiday"</span>,</span>
<span>                       skip <span class="op">=</span> <span class="fl">11</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">USD</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">mutate</span><span class="op">(</span>lnR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">USD</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">lnR</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">CAD</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Date</span>, y <span class="op">=</span> <span class="va">USD</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ylab</span><span class="op">(</span><span class="st">"CAD per USD"</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">CAD</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Date</span>, y <span class="op">=</span> <span class="va">lnR</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ylab</span><span class="op">(</span><span class="st">"Log return"</span><span class="op">)</span></span>
<span><span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span></span>
<span>    <span class="fu">plot_annotation</span><span class="op">(</span>tag_levels <span class="op">=</span> <span class="st">'A'</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div id="fig-CAD" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-CAD-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="l06_garch_files/figure-html/fig-CAD-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-CAD-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.1: CAD per USD daily noon exchange rates and log returns, from 2006-02-22 to 2016-02-22 (excluding bank holidays), obtained from <a href="https://www.bankofcanada.ca/rates/exchange/daily-exchange-rates-lookup/">Bank of Canada</a>.
</figcaption></figure>
</div>
</div>
</div>
<p><span class="citation" data-cites="Rydberg:2000">Rydberg (<a href="references.html#ref-Rydberg:2000" role="doc-biblioref">2000</a>)</span> summarizes some important <em>stylized features</em> of financial return series, which have been repeatedly observed in all kinds of assets including stock prices, interest rates, and foreign exchange rates:</p>
<ol type="1">
<li>
<em>Heavy tails.</em> The distribution of the returns <span class="math inline">\(X_t\)</span> has tails heavier than the tails of a normal distribution.</li>
<li>
<em>Volatility clustering.</em> Large price changes occur in clusters. Indeed, often large price changes tend to be followed by large price changes, and periods of tranquility alternate with periods of high volatility.</li>
<li>
<em>Asymmetry.</em> There is evidence that the distribution of stock returns is slightly negatively skewed. One possible explanation could be that trades react more strongly to negative information than to positive information.</li>
<li>
<em>Aggregational Gaussianity.</em> When the sampling frequency decreases, the central limit law sets in and the distribution of the returns over a long period tends toward a normal distribution.</li>
<li>
<em>Long-range dependence.</em> The returns themselves hardly show any autocorrelation, which, however, does not mean that they are independent. Both squared returns and absolute returns often exhibit persistent autocorrelations indicating possible long-memory dependence in those series.</li>
</ol>
<p><a href="#fig-CADACF" class="quarto-xref">Figure&nbsp;<span>6.2</span></a> is the simplest check for the presence of ARCH effects: when the time series is not autocorrelated but is autocorrelated if squared.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">forecast</span><span class="fu">::</span><span class="fu"><a href="https://pkg.robjhyndman.com/forecast/reference/autoplot.acf.html">ggAcf</a></span><span class="op">(</span><span class="va">CAD</span><span class="op">$</span><span class="va">lnR</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Log returns"</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">forecast</span><span class="fu">::</span><span class="fu"><a href="https://pkg.robjhyndman.com/forecast/reference/autoplot.acf.html">ggAcf</a></span><span class="op">(</span><span class="va">CAD</span><span class="op">$</span><span class="va">lnR</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggtitle</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/bquote.html">bquote</a></span><span class="op">(</span><span class="st">'(Log returns)'</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span></span>
<span>    <span class="fu">plot_annotation</span><span class="op">(</span>tag_levels <span class="op">=</span> <span class="st">'A'</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div id="fig-CADACF" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-CADACF-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="l06_garch_files/figure-html/fig-CADACF-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-CADACF-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.2: ACF of log returns and squared log returns for USD/CAD exchange.
</figcaption></figure>
</div>
</div>
</div>
<p>For comparison, see <a href="#fig-iidACF" class="quarto-xref">Figure&nbsp;<span>6.3</span></a> with similar plots for simulated i.i.d. series.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">iid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">CAD</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">forecast</span><span class="fu">::</span><span class="fu"><a href="https://pkg.robjhyndman.com/forecast/reference/autoplot.acf.html">ggAcf</a></span><span class="op">(</span><span class="va">iid</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"iid"</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">forecast</span><span class="fu">::</span><span class="fu"><a href="https://pkg.robjhyndman.com/forecast/reference/autoplot.acf.html">ggAcf</a></span><span class="op">(</span><span class="va">iid</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggtitle</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/bquote.html">bquote</a></span><span class="op">(</span><span class="st">'iid'</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span></span>
<span>    <span class="fu">plot_annotation</span><span class="op">(</span>tag_levels <span class="op">=</span> <span class="st">'A'</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div id="fig-iidACF" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-iidACF-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="l06_garch_files/figure-html/fig-iidACF-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-iidACF-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.3: ACF of simulated i.i.d. <span class="math inline">\(N(0,1)\)</span> series.
</figcaption></figure>
</div>
</div>
</div>
</section><section id="models" class="level2" data-number="6.3"><h2 data-number="6.3" class="anchored" data-anchor-id="models">
<span class="header-section-number">6.3</span> Models</h2>
<p><span class="citation" data-cites="Engle:1982">Engle (<a href="references.html#ref-Engle:1982" role="doc-biblioref">1982</a>)</span> defines an autoregressive conditional heteroskedastic (ARCH) model as <span id="eq-ARCH"><span class="math display">\[
\begin{split}
X_{t} &amp;=  \sigma_{t} \varepsilon_{t}, \\
\sigma^{2}_{t} &amp;=  a_{0} + a_{1} X^{2}_{t-1} + \dots + a_{p} X^{2}_{t-p},
\end{split}
\tag{6.4}\]</span></span> where <span class="math inline">\(a_{0} &gt; 0\)</span>, <span class="math inline">\(a_{j} \geqslant 0\)</span>, <span class="math inline">\(\varepsilon_{t} \sim \mathrm{i.i.d.}(0,1)\)</span>, and <span class="math inline">\(\varepsilon_{t}\)</span> is independent of <span class="math inline">\(X_{t - j}\)</span>, where <span class="math inline">\(j \geqslant 1\)</span>. We write <span class="math inline">\(X_{t} \sim \mathrm{ARCH} (p)\)</span>.</p>
<p>We can see that <span class="math display">\[
\begin{split}
\mathrm{E} X_{t} &amp; =  0, \\
\mathrm{var} \left( X_{t} | X_{t - 1} , \dots , X_{t - p} \right) &amp;= \sigma^{2}_{t}, \\
\mathrm{cov} \left( X_{t} , X_{k} \right) &amp;= 0 ~~\mathrm{for~all}~~ t \neq k.
\end{split}
\]</span></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Stationary ARCH is white noise.</p>
</div>
</div>
<p>Thus, in ARCH, the predictive distribution of <span class="math inline">\(X_{t}\)</span> based on its past is a scale-transform of the distribution of <span class="math inline">\(\varepsilon_{t}\)</span> with the scaling constant <span class="math inline">\(\sigma_{t}\)</span> depending on the past of the process.</p>
<p><span class="citation" data-cites="Bollerslev:1986">Bollerslev (<a href="references.html#ref-Bollerslev:1986" role="doc-biblioref">1986</a>)</span> introduced a generalized autoregressive conditional heteroskedastic (GARCH) model by replacing the second formula in <a href="#eq-ARCH" class="quarto-xref">Equation&nbsp;<span>6.4</span></a> with <span id="eq-GARCH"><span class="math display">\[
\begin{split}
\sigma^{2}_{t} &amp;= a_{0}  + a_{1} X^{2}_{ t  - 1} + \dots + a_{p} X^{2}_{ t  - p} + b_{1} \sigma^{2}_{t - 1} + \dots + b_{q} \sigma^{2}_{t  - q}\\
&amp;= a_0  + \sum_{i=1}^p a_{i} X^{2}_{ t  - i} + \sum_{j=1}^q b_{j} \sigma^{2}_{ t  - j},
\end{split}
\tag{6.5}\]</span></span> where <span class="math inline">\(a_{0} &gt; 0\)</span>, <span class="math inline">\(a_{i} \geqslant 0\)</span>, and <span class="math inline">\(b_{j} \geqslant 0\)</span>. We write <span class="math inline">\(X_{t}  \sim  \mathrm{GARCH}(p, q)\)</span>.</p>
<p>Notice the similarity between ARMA and GARCH models.</p>
<p>The parameters of ARCH/GARCH models are estimated using the method of conditional maximum likelihood. There exist several tests for ARCH/GARCH effects (e.g., analyzing time series and ACF plots, the Engleâ€™s Lagrange multiplier test).</p>
<p>The approaches to selecting the orders <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> for GARCH include:</p>
<ul>
<li>Visual analysis of ACF and PACF of the squared time series and other residual diagnostics;</li>
<li>Variations of information criteria such as AIC and BIC to account for the number of estimated parameters in the GARCH model <span class="citation" data-cites="Brooks:Burke:2003">(<a href="references.html#ref-Brooks:Burke:2003" role="doc-biblioref">Brooks and Burke 2003</a>)</span>;</li>
<li>Using GARCH(1,1) by following <span class="citation" data-cites="Hansen:Lunde:2005">Hansen and Lunde (<a href="references.html#ref-Hansen:Lunde:2005" role="doc-biblioref">2005</a>)</span>;</li>
<li>Using out-of-sample forecasts (comparing alternative model specifications on a testing set).</li>
</ul>
<section id="lagrange-multiplier-test" class="level3" data-number="6.3.1"><h3 data-number="6.3.1" class="anchored" data-anchor-id="lagrange-multiplier-test">
<span class="header-section-number">6.3.1</span> Lagrange multiplier test</h3>
<p>The Lagrange multiplier (LM) test is equivalent to an <span class="math inline">\(F\)</span>-test for the significance of the least squares regression on squared values: <span id="eq-LMtregression"><span class="math display">\[
X^{2}_{t} = \alpha_0  + \alpha_1 X^{2}_{t-1} + \dots + \alpha_m X^{2}_{t-m} + e_t,
\tag{6.6}\]</span></span> where <span class="math inline">\(e_t\)</span> denotes the error term, <span class="math inline">\(m\)</span> is a positive integer, <span class="math inline">\(t = m+1,\dots,T\)</span>, and <span class="math inline">\(T\)</span> is the sample size (length of the time series).</p>
<p>Specifically, the null hypothesis is <span class="math display">\[
H_0: \alpha_1 = \dots = \alpha_m = 0.
\]</span> Let the sum of squares total <span class="math display">\[
SST = \sum_{t=m+1}^T \left( X_t^2 - \overline{X_t^2} \right) ^2,
\]</span> where <span class="math inline">\(\overline{X_t^2}\)</span> is the sample mean of <span class="math inline">\(X_t^2\)</span>. The sum of squares of the errors <span class="math display">\[
SSE = \sum_{t=m+1}^T \hat{e}_t^2,
\]</span> where <span class="math inline">\(\hat{e}_t\)</span> is the least-squares residual of the linear regression (<a href="#eq-LMtregression" class="quarto-xref">Equation&nbsp;<span>6.6</span></a>).</p>
<p>Then, the test statistic <span id="eq-LMFtest"><span class="math display">\[
F = \frac{(SST - SSE)/m}{SSE/(T-2m-1)},
\tag{6.7}\]</span></span> which is asymptotically distributed under the null hypothesis as a <span class="math inline">\(\chi^2\)</span> distribution with <span class="math inline">\(m\)</span> degrees of freedom.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Example: Testing ARCH effects in USD/CAD log returns
</div>
</div>
<div class="callout-body-container callout-body">
<p>We have seen in <a href="#fig-CADACF" class="quarto-xref">Figure&nbsp;<span>6.2</span></a> the autocorrelation of squared log returns. Now apply the formal LM test.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fl">12</span></span>
<span><span class="fu">FinTS</span><span class="fu">::</span><span class="fu"><a href="https://geobosh.github.io/FinTSDoc/reference/ArchTest.html">ArchTest</a></span><span class="op">(</span><span class="va">CAD</span><span class="op">$</span><span class="va">lnR</span>, lags <span class="op">=</span> <span class="va">m</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  ARCH LM-test; Null hypothesis: no ARCH effects
#&gt; 
#&gt; data:  CAD$lnR
#&gt; Chi-squared = 377, df = 12, p-value &lt;2e-16</code></pre>
</div>
</div>
<p>The LM test implemented in the function <code><a href="https://geobosh.github.io/FinTSDoc/reference/ArchTest.html">FinTS::ArchTest()</a></code> detects the presence of ARCH effects (rejects the null hypothesis) when considering 12 lags. In base R, the same results can be obtained by running the <span class="math inline">\(F\)</span> test as follows:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/embed.html">embed</a></span><span class="op">(</span><span class="va">CAD</span><span class="op">$</span><span class="va">lnR</span><span class="op">^</span><span class="fl">2</span>, <span class="va">m</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">mat</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">~</span> <span class="va">mat</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; Analysis of Variance Table
#&gt; 
#&gt; Response: mat[, 1]
#&gt;             Df   Sum Sq  Mean Sq F value Pr(&gt;F)    
#&gt; mat[, -1]   12 5.15e-06 4.29e-07    36.8 &lt;2e-16 ***
#&gt; Residuals 2479 2.89e-05 1.20e-08                   
#&gt; ---
#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Example: GARCH model for USD/CAD log returns
</div>
</div>
<div class="callout-body-container callout-body">
<p>Letâ€™s estimate a GARCH(1,1) model for these data, using the conditional ML method. Note that <code>omega</code> in the results below is denoted <span class="math inline">\(a_0\)</span> in our equations (the intercept in the variance model):</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://geobosh.github.io/fGarchDoc/">fGarch</a></span><span class="op">)</span></span>
<span><span class="va">garch11</span> <span class="op">&lt;-</span> <span class="fu">fGarch</span><span class="fu">::</span><span class="fu"><a href="https://geobosh.github.io/fGarchDoc/reference/garchFit.html">garchFit</a></span><span class="op">(</span><span class="va">lnR</span> <span class="op">~</span> <span class="fu">garch</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>                            data <span class="op">=</span> <span class="va">CAD</span>, trace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">garch11</span><span class="op">@</span><span class="va">description</span> <span class="op">&lt;-</span> <span class="st">"---"</span></span>
<span><span class="va">garch11</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt; Title:
#&gt;  GARCH Modelling 
#&gt; 
#&gt; Call:
#&gt;  fGarch::garchFit(formula = lnR ~ garch(1, 1), data = CAD, trace = FALSE) 
#&gt; 
#&gt; Mean and Variance Equation:
#&gt;  lnR ~ garch(1, 1)
#&gt;  [data = CAD]
#&gt; 
#&gt; Conditional Distribution:
#&gt;  norm 
#&gt; 
#&gt; Coefficient(s):
#&gt;          mu        omega       alpha1        beta1  
#&gt; -4.5264e-05   2.2304e-07   5.6511e-02   9.3805e-01  
#&gt; 
#&gt; Std. Errors:
#&gt;  based on Hessian 
#&gt; 
#&gt; Error Analysis:
#&gt;          Estimate  Std. Error  t value Pr(&gt;|t|)    
#&gt; mu     -4.526e-05   9.863e-05   -0.459  0.64630    
#&gt; omega   2.230e-07   6.893e-08    3.236  0.00121 ** 
#&gt; alpha1  5.651e-02   6.699e-03    8.436  &lt; 2e-16 ***
#&gt; beta1   9.381e-01   6.846e-03  137.013  &lt; 2e-16 ***
#&gt; ---
#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#&gt; 
#&gt; Log Likelihood:
#&gt;  9445    normalized:  3.77 
#&gt; 
#&gt; Description:
#&gt;  ---</code></pre>
</div>
</div>
<p>Next, we run diagnostics of the fitted model, i.e., whether the residuals <span class="math inline">\(\varepsilon_{t}\)</span> are white noise and are normally distributed. The code <code>plot(garch11)</code> generates scatterplots, histograms, Q-Q plots, and ACF plots of the original data and the obtained residuals (<a href="#fig-garch11QQ" class="quarto-xref">Figure&nbsp;<span>6.4</span></a>). Of course, the analysis can be performed also with separate commands. For example, see the ACFs of the residuals (<a href="#fig-garch11ACF" class="quarto-xref">Figure&nbsp;<span>6.5</span></a>).</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://geobosh.github.io/fGarchDoc/reference/methods-plot.html">plot</a></span><span class="op">(</span><span class="va">garch11</span>, which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">13</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div id="fig-garch11QQ" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-garch11QQ-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="l06_garch_files/figure-html/fig-garch11QQ-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-garch11QQ-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.4: Selected diagnostics of the GARCH(1,1) model for the USD/CAD log returns.
</figcaption></figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">et</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://geobosh.github.io/fGarchDoc/reference/methods-residuals.html">residuals</a></span><span class="op">(</span><span class="va">garch11</span>, standardize <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">forecast</span><span class="fu">::</span><span class="fu"><a href="https://pkg.robjhyndman.com/forecast/reference/autoplot.acf.html">ggAcf</a></span><span class="op">(</span><span class="va">et</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Residuals"</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">forecast</span><span class="fu">::</span><span class="fu"><a href="https://pkg.robjhyndman.com/forecast/reference/autoplot.acf.html">ggAcf</a></span><span class="op">(</span><span class="va">et</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggtitle</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/bquote.html">bquote</a></span><span class="op">(</span><span class="st">'Residuals'</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span></span>
<span>    <span class="fu">plot_annotation</span><span class="op">(</span>tag_levels <span class="op">=</span> <span class="st">'A'</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div id="fig-garch11ACF" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-garch11ACF-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="l06_garch_files/figure-html/fig-garch11ACF-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-garch11ACF-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.5: ACF of residuals from the GARCH(1,1) model for the USD/CAD log returns.
</figcaption></figure>
</div>
</div>
</div>
<p>Based on the plots, autocorrelations were effectively removed, but the assumption of normality is violated â€“ <a href="#fig-garch11QQ" class="quarto-xref">Figure&nbsp;<span>6.4</span></a> shows heavy and almost symmetric tails in the distribution of GARCH residuals.</p>
<p>To account for the heavy tails, we change the conditional distribution from normal to the standardized Student <span class="math inline">\(t\)</span>-distribution (see <code><a href="https://geobosh.github.io/fGarchDoc/reference/dist-std.html">?fGarch::std</a></code>).</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">garch11t</span> <span class="op">&lt;-</span> <span class="fu">fGarch</span><span class="fu">::</span><span class="fu"><a href="https://geobosh.github.io/fGarchDoc/reference/garchFit.html">garchFit</a></span><span class="op">(</span><span class="va">lnR</span> <span class="op">~</span> <span class="fu">garch</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>                             data <span class="op">=</span> <span class="va">CAD</span>, trace <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                             cond.dist <span class="op">=</span> <span class="st">"std"</span><span class="op">)</span></span>
<span><span class="va">garch11t</span><span class="op">@</span><span class="va">description</span> <span class="op">&lt;-</span> <span class="st">"---"</span></span>
<span><span class="va">garch11t</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt; Title:
#&gt;  GARCH Modelling 
#&gt; 
#&gt; Call:
#&gt;  fGarch::garchFit(formula = lnR ~ garch(1, 1), data = CAD, cond.dist = "std", 
#&gt;     trace = FALSE) 
#&gt; 
#&gt; Mean and Variance Equation:
#&gt;  lnR ~ garch(1, 1)
#&gt;  [data = CAD]
#&gt; 
#&gt; Conditional Distribution:
#&gt;  std 
#&gt; 
#&gt; Coefficient(s):
#&gt;          mu        omega       alpha1        beta1        shape  
#&gt; -3.1972e-05   1.8744e-07   5.5352e-02   9.4057e-01   8.6423e+00  
#&gt; 
#&gt; Std. Errors:
#&gt;  based on Hessian 
#&gt; 
#&gt; Error Analysis:
#&gt;          Estimate  Std. Error  t value Pr(&gt;|t|)    
#&gt; mu     -3.197e-05   9.433e-05   -0.339   0.7346    
#&gt; omega   1.874e-07   8.038e-08    2.332   0.0197 *  
#&gt; alpha1  5.535e-02   7.765e-03    7.128 1.02e-12 ***
#&gt; beta1   9.406e-01   7.760e-03  121.209  &lt; 2e-16 ***
#&gt; shape   8.642e+00   1.420e+00    6.084 1.17e-09 ***
#&gt; ---
#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#&gt; 
#&gt; Log Likelihood:
#&gt;  9473    normalized:  3.78 
#&gt; 
#&gt; Description:
#&gt;  ---</code></pre>
</div>
</div>
<p>Verify the diagnostics plots in <a href="#fig-garch11tQQ" class="quarto-xref">Figure&nbsp;<span>6.6</span></a>.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://geobosh.github.io/fGarchDoc/reference/methods-plot.html">plot</a></span><span class="op">(</span><span class="va">garch11t</span>, which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">13</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://geobosh.github.io/fGarchDoc/reference/methods-plot.html">plot</a></span><span class="op">(</span><span class="va">garch11t</span>, which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">11</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div id="fig-garch11tQQ" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-garch11tQQ-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="l06_garch_files/figure-html/fig-garch11tQQ-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-garch11tQQ-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.6: Selected diagnostics of the GARCH(1,1) model with the standardized Student-t distribution for the USD/CAD log returns.
</figcaption></figure>
</div>
</div>
</div>
<p>Now we can use the model for predictions (<a href="#fig-garch11tpred" class="quarto-xref">Figure&nbsp;<span>6.7</span></a>). Few things to note here:</p>
<ul>
<li>the model is â€˜self-containedâ€™ so we can just specify <code>n.ahead</code> for the number of steps to be predicted;</li>
<li>GARCH models are typically applied to long time series, so the argument <code>nx</code> limits the length of the plotted observed time series (by default only the most recent 25% of observations are plotted);</li>
<li>the argument <code>conf</code> specifies the confidence level, then the conditional distribution from the model is used to compute critical values for the interval forecasts. Alternatively, one can specify the critical values manually with the argument <code>crit_val</code>.</li>
</ul>
<p>For more details, see <code><a href="https://geobosh.github.io/fGarchDoc/reference/methods-predict.html">?fGarch::predict</a></code>.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://geobosh.github.io/fGarchDoc/reference/methods-predict.html">predict</a></span><span class="op">(</span><span class="va">garch11t</span>, n.ahead <span class="op">=</span> <span class="fl">30</span>, </span>
<span>        conf <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>        plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>#&gt;    meanForecast meanError standardDeviation lowerInterval upperInterval
#&gt; 1      -3.2e-05   0.00445           0.00445      -0.00892       0.00885
#&gt; 2      -3.2e-05   0.00446           0.00446      -0.00894       0.00888
#&gt; 3      -3.2e-05   0.00448           0.00448      -0.00896       0.00890
#&gt; 4      -3.2e-05   0.00449           0.00449      -0.00899       0.00892
#&gt; 5      -3.2e-05   0.00450           0.00450      -0.00901       0.00895
#&gt; 6      -3.2e-05   0.00451           0.00451      -0.00903       0.00897
#&gt; 7      -3.2e-05   0.00452           0.00452      -0.00906       0.00899
#&gt; 8      -3.2e-05   0.00453           0.00453      -0.00908       0.00902
#&gt; 9      -3.2e-05   0.00455           0.00455      -0.00910       0.00904
#&gt; 10     -3.2e-05   0.00456           0.00456      -0.00913       0.00906
#&gt; 11     -3.2e-05   0.00457           0.00457      -0.00915       0.00908
#&gt; 12     -3.2e-05   0.00458           0.00458      -0.00917       0.00911
#&gt; 13     -3.2e-05   0.00459           0.00459      -0.00919       0.00913
#&gt; 14     -3.2e-05   0.00460           0.00460      -0.00921       0.00915
#&gt; 15     -3.2e-05   0.00461           0.00461      -0.00924       0.00917
#&gt; 16     -3.2e-05   0.00462           0.00462      -0.00926       0.00919
#&gt; 17     -3.2e-05   0.00463           0.00463      -0.00928       0.00922
#&gt; 18     -3.2e-05   0.00464           0.00464      -0.00930       0.00924
#&gt; 19     -3.2e-05   0.00466           0.00466      -0.00932       0.00926
#&gt; 20     -3.2e-05   0.00467           0.00467      -0.00934       0.00928
#&gt; 21     -3.2e-05   0.00468           0.00468      -0.00937       0.00930
#&gt; 22     -3.2e-05   0.00469           0.00469      -0.00939       0.00932
#&gt; 23     -3.2e-05   0.00470           0.00470      -0.00941       0.00934
#&gt; 24     -3.2e-05   0.00471           0.00471      -0.00943       0.00936
#&gt; 25     -3.2e-05   0.00472           0.00472      -0.00945       0.00938
#&gt; 26     -3.2e-05   0.00473           0.00473      -0.00947       0.00940
#&gt; 27     -3.2e-05   0.00474           0.00474      -0.00949       0.00942
#&gt; 28     -3.2e-05   0.00475           0.00475      -0.00951       0.00945
#&gt; 29     -3.2e-05   0.00476           0.00476      -0.00953       0.00947
#&gt; 30     -3.2e-05   0.00477           0.00477      -0.00955       0.00949</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-garch11tpred" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-garch11tpred-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="l06_garch_files/figure-html/fig-garch11tpred-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-garch11tpred-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.7: Predictions using the GARCH(1,1) model for the USD/CAD log returns.
</figcaption></figure>
</div>
</div>
</div>
</div>
</div>
</section></section><section id="extensions" class="level2" data-number="6.4"><h2 data-number="6.4" class="anchored" data-anchor-id="extensions">
<span class="header-section-number">6.4</span> Extensions</h2>
<p>There was a boom in creating new models by adding new features to GARCH:</p>
<ul>
<li>IGARCH â€“ integrated GARCH</li>
<li>EGARCH â€“ exponential GARCH</li>
<li>TGARCH â€“ threshold GARCH</li>
<li>QGARCH â€“ quadratic GARCH</li>
<li>GARCH-M â€“ GARCH with heteroskedasticity in mean</li>
<li>NGARCH â€“ nonlinear GARCH</li>
<li>â€¦</li>
<li>MARCH â€“ modified GARCH</li>
<li>STARCH â€“ structural ARCH</li>
<li>â€¦</li>
</ul>
<p>Thus, these papers had to appear: <span class="citation" data-cites="Hansen:Lunde:2005">Hansen and Lunde (<a href="references.html#ref-Hansen:Lunde:2005" role="doc-biblioref">2005</a>)</span> and <span class="citation" data-cites="Bollerslev:2009">Bollerslev (<a href="references.html#ref-Bollerslev:2009" role="doc-biblioref">2009</a>)</span>.</p>
</section><section id="model-building" class="level2" data-number="6.5"><h2 data-number="6.5" class="anchored" data-anchor-id="model-building">
<span class="header-section-number">6.5</span> Model building</h2>
<p>We have considered the models for conditional heteroskedasticity, and in the example, we estimated the mean just as a constant (intercept <code>mu</code>), however, in a more general case one might need to model and remove trend and cyclical variability along with autocorrelations (recall the methods of smoothing, ARMA, and ARIMA modeling) before exploring the need to model ARCH.</p>
<p>Below are the steps for such a more general case of analysis, adapted from Chapter 3.3 in <span class="citation" data-cites="Tsay:2005">Tsay (<a href="references.html#ref-Tsay:2005" role="doc-biblioref">2005</a>)</span>:</p>
<ol type="1">
<li>Specify a mean equation by testing for trend and serial dependence in the data and, if necessary, build a time series model (e.g., an ARMA model) to remove any linear dependence.</li>
<li>Use the residuals of the mean equation to test for ARCH effects.</li>
<li>If the ARCH effects are statistically significant, specify a volatility model and perform a <em>joint estimation</em> of the mean and volatility equations.</li>
<li>Check the fitted model carefully and refine it if necessary.</li>
</ol>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The joint estimation can be done in R using the function <code><a href="https://geobosh.github.io/fGarchDoc/reference/garchFit.html">fGarch::garchFit()</a></code> and specifying, e.g., <code>formula = ~ arma(2, 1) + garch(1, 1)</code>.</p>
</div>
</div>
</section><section id="conclusion" class="level2" data-number="6.6"><h2 data-number="6.6" class="anchored" data-anchor-id="conclusion">
<span class="header-section-number">6.6</span> Conclusion</h2>
<p>Whereas originated in financial analysis, GARCH models are becoming popular in other domains, including environmental science. Note that close alternatives exist, for example, GAMLSS allows modeling different distributional parameters such as mean, scale, skewness, etc.</p>
<p>GARCH effects are tested for and modeled <em>after</em> the mean (i.e., trend) and autocorrelations are removed. Standard model selection techniques can be adapted to specify GARCH models.</p>
<p>R packages offering functions for GARCH modeling include (in alphabetic order): <code>bayesforecast</code>, <code>betategarch</code>, <code>fGarch</code> (used here), <code>garchx</code>, <code>rmgarch</code>, <code>rugarch</code>, <code>tseries</code>, and more (see, for example, CRAN Task Views on <a href="https://cran.r-project.org/web/views/Finance.html">Empirical Finance</a>).</p>


<div id="refs" class="references csl-bib-body hanging-indent" role="list" style="display: none">
<div id="ref-Bollerslev:1986" class="csl-entry" role="listitem">
Bollerslev T (1986) Generalized autoregressive conditional heteroskedasticity. Journal of Econometrics 31:307â€“327. <a href="https://doi.org/10.1016/0304-4076(86)90063-1">https://doi.org/10.1016/0304-4076(86)90063-1</a>
</div>
<div id="ref-Bollerslev:2009" class="csl-entry" role="listitem">
Bollerslev T (2009) <a href="https://doi.org/10.2139/ssrn.1263250">Glossary to <span>ARCH</span> <span>(GARCH)</span></a>. In: Volatility and time series econometrics: Essays in honour of <span>Robert F. Engle</span>. SSRN
</div>
<div id="ref-Brooks:Burke:2003" class="csl-entry" role="listitem">
Brooks C, Burke SP (2003) Information criteria for <span>GARCH</span> model selection. The European Journal of Finance 9:557â€“580. <a href="https://doi.org/10.1080/1351847021000029188">https://doi.org/10.1080/1351847021000029188</a>
</div>
<div id="ref-Campbell:Diebold:2005" class="csl-entry" role="listitem">
Campbell SD, Diebold FX (2005) Weather forecasting for weather derivatives. Journal of the American Statistical Association 100:6â€“16. <a href="https://doi.org/10.1198/016214504000001051">https://doi.org/10.1198/016214504000001051</a>
</div>
<div id="ref-Cripps:Dunsmuir:2003" class="csl-entry" role="listitem">
Cripps E, Dunsmuir WTM (2003) Modeling the variability of <span>Sydney</span> <span>Harbor</span> wind measurements. Journal of Applied Meteorology 42:1131â€“1138. <a href="https://doi.org/10.1175/1520-0450(2003)042<1131:MTVOSH>2.0.CO;2">https://doi.org/10.1175/1520-0450(2003)042&lt;1131:MTVOSH&gt;2.0.CO;2</a>
</div>
<div id="ref-Engle:1982" class="csl-entry" role="listitem">
Engle RF (1982) Autoregressive conditional heteroscedasticity with estimates of the variance of <span>United</span> <span>Kingdom</span> inflation. Econometrica 50:987â€“1007. <a href="https://doi.org/10.2307/1912773">https://doi.org/10.2307/1912773</a>
</div>
<div id="ref-Hansen:Lunde:2005" class="csl-entry" role="listitem">
Hansen PR, Lunde A (2005) A comparison of volatility models: Does anything beat a <span>GARCH</span>(1, 1)? Journal of Applied Econometrics 20:873â€“889. <a href="https://doi.org/10.1002/jae.800">https://doi.org/10.1002/jae.800</a>
</div>
<div id="ref-Kirchgassner:Wolters:2007" class="csl-entry" role="listitem">
KirchgÃ¤ssner G, Wolters J (2007) <a href="https://doi.org/10.1007/978-3-540-73291-4">Introduction to modern time series analysis</a>. Springer-Verlag, Berlin, Germany
</div>
<div id="ref-Marinova:McAleer:2003" class="csl-entry" role="listitem">
Marinova D, McAleer M (2003) Modelling trends and volatility in ecological patents in the <span>USA</span>. Environmental Modelling &amp; Software 18:195â€“203. <a href="https://doi.org/10.1016/S1364-8152(02)00079-8">https://doi.org/10.1016/S1364-8152(02)00079-8</a>
</div>
<div id="ref-Rydberg:2000" class="csl-entry" role="listitem">
Rydberg TH (2000) Realistic statistical modelling of financial data. International Statistical Review 68:233â€“258. <a href="https://doi.org/10.2307/1403412">https://doi.org/10.2307/1403412</a>
</div>
<div id="ref-Taylor:Buizza:2004" class="csl-entry" role="listitem">
Taylor JW, Buizza R (2004) A comparison of temperature density forecasts from <span>GARCH</span> and atmospheric models. Journal of Forecasting 23:337â€“355. <a href="https://doi.org/10.1002/for.917">https://doi.org/10.1002/for.917</a>
</div>
<div id="ref-Tsay:2005" class="csl-entry" role="listitem">
Tsay RS (2005) Analysis of financial time series, 2nd edn. John Wiley &amp; Sons, Hoboken, NJ, USA
</div>
</div>
</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "î§‹";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./l05_arima.html" class="pagination-link" aria-label="Autoregressive Integrated Moving Average (ARIMA) Models">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Autoregressive Integrated Moving Average (ARIMA) Models</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./l07_trendtest.html" class="pagination-link" aria-label="Trend Detection">
        <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Trend Detection</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/vlyubchich/tsar/edit/master/l06_garch.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/vlyubchich/tsar/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>