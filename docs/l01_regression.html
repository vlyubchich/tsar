<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Time Series Analysis - 1&nbsp; Review of Linear Regression</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./l02_tsintro.html" rel="next">
<link href="./index.html" rel="prev">
<link href="./TSAfav.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Review of Linear Regression</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Time Series Analysis</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/vlyubchich/tsar/" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle sidebar-tool" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./l01_regression.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Review of Linear Regression</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./l02_tsintro.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction to Time Series Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./l03_smoothing.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Smoothing, Detrending, and Deseasonalizing</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./l04_arma.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Autoregressive Moving Average (ARMA) Models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./l05_arima.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Autoregressive Integrated Moving Average (ARIMA) Models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./l06_garch.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Generalized Autoregressive Conditional Heteroskedasticity (GARCH) Models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./l07_trendtest.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Trend Detection</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./l08_tsreg1.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Time Series Regression with Trends</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./l09_tsreg2.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Time Series Regression with Correlated Errors</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./l13_spectral.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Spectral Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./software.html" class="sidebar-item-text sidebar-link">Software</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Appendices</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./s1_wls.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Weighted least squares</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./s2_gls.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Generalized least squares</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./s4_trendsync.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Synchrony of parametric trends</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./s_practice.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Practice exercises</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#diagnostics-for-the-simple-linear-regression-residual-analysis" id="toc-diagnostics-for-the-simple-linear-regression-residual-analysis" class="nav-link active" data-scroll-target="#diagnostics-for-the-simple-linear-regression-residual-analysis"><span class="toc-section-number">1.1</span>  Diagnostics for the simple linear regression: residual analysis</a>
  <ul class="collapse">
<li><a href="#homoskedasticity" id="toc-homoskedasticity" class="nav-link" data-scroll-target="#homoskedasticity"><span class="toc-section-number">1.1.1</span>  Homoskedasticity</a></li>
  <li><a href="#uncorrelatedness" id="toc-uncorrelatedness" class="nav-link" data-scroll-target="#uncorrelatedness"><span class="toc-section-number">1.1.2</span>  Uncorrelatedness</a></li>
  <li><a href="#normality" id="toc-normality" class="nav-link" data-scroll-target="#normality"><span class="toc-section-number">1.1.3</span>  Normality</a></li>
  <li><a href="#summary-of-the-simple-linear-regression-residual-diagnostics" id="toc-summary-of-the-simple-linear-regression-residual-diagnostics" class="nav-link" data-scroll-target="#summary-of-the-simple-linear-regression-residual-diagnostics"><span class="toc-section-number">1.1.4</span>  Summary of the simple linear regression residual diagnostics</a></li>
  </ul>
</li>
  <li>
<a href="#multiple-linear-regression" id="toc-multiple-linear-regression" class="nav-link" data-scroll-target="#multiple-linear-regression"><span class="toc-section-number">1.2</span>  Multiple linear regression</a>
  <ul class="collapse">
<li><a href="#summary-of-the-multiple-linear-regression-residual-diagnostics" id="toc-summary-of-the-multiple-linear-regression-residual-diagnostics" class="nav-link" data-scroll-target="#summary-of-the-multiple-linear-regression-residual-diagnostics"><span class="toc-section-number">1.2.1</span>  Summary of the multiple linear regression residual diagnostics</a></li>
  </ul>
</li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="toc-section-number">1.3</span>  Conclusion</a></li>
  <li><a href="#sec-diffsign" id="toc-sec-diffsign" class="nav-link" data-scroll-target="#sec-diffsign"><span class="toc-section-number">1.4</span>  Appendix</a></li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/vlyubchich/tsar/edit/master/l01_regression.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/vlyubchich/tsar/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-regression" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Review of Linear Regression</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><div class="cell">

</div>
<p>After this lecture, you should be competent (again) in assessing violations of various assumptions of linear regression models, particularly assumptions about model residuals, by being able to apply visual assessments and formal statistical tests, and interpret the results and effects of the violations.</p>
<p><strong>Objectives</strong></p>
<ol type="1">
<li>Recall the form and standard assumptions of linear regression models.</li>
<li>Recall and apply standard methods of assessing and testing homogeneity of variance and normality of residuals.</li>
<li>Define and test independence (most often, uncorrelatedness) of regression model residuals.</li>
</ol>
<p><strong>Reading materials</strong></p>
<ul>
<li>Chapters 3–4 in <span class="citation" data-cites="Chatterjee:Hadi:2006">Chatterjee and Hadi (<a href="references.html#ref-Chatterjee:Hadi:2006" role="doc-biblioref">2006</a>)</span>
</li>
</ul>
<section id="diagnostics-for-the-simple-linear-regression-residual-analysis" class="level2" data-number="1.1"><h2 data-number="1.1" class="anchored" data-anchor-id="diagnostics-for-the-simple-linear-regression-residual-analysis">
<span class="header-section-number">1.1</span> Diagnostics for the simple linear regression: residual analysis</h2>
<p>Given a simple linear regression (SLR) model <span class="math display">\[
Y_{t} = \beta_{0} + \beta_{1} X_{t} + \epsilon_{t},
\]</span> where <span class="math inline">\(Y_{t}\)</span> is the dependent variable and <span class="math inline">\(X_{t}\)</span> is the regressor (independent, predictor) variable, <span class="math inline">\(t = 1,\dots,n\)</span>, and <span class="math inline">\(n\)</span> is the sample size.</p>
<p><strong>The Gauss–Markov theorem</strong></p>
<p>If <span class="math inline">\(\epsilon_{t}\)</span> are uncorrelated random variables with common variance, then of all possible estimators <span class="math inline">\(\beta^{\ast}_{0}\)</span> and <span class="math inline">\(\beta^{\ast}_{1}\)</span> that are linear functions of <span class="math inline">\(Y_{t}\)</span>, the least squares estimators have the smallest variance.</p>
<p>Thus, the ordinary least squares (OLS) assumptions are:</p>
<ol type="1">
<li><p>the residuals <span class="math inline">\(\epsilon_{t}\)</span> have common variance (<span class="math inline">\(\epsilon_{t}\)</span> are homoskedastic);</p></li>
<li>
<p>the residuals <span class="math inline">\(\epsilon_{t}\)</span> are uncorrelated;</p>
<p>to provide prediction intervals (PIs), confidence intervals (CIs), and to test hypotheses about the parameters in our model, we also need to assume that</p>
</li>
<li><p>the residuals <span class="math inline">\(\epsilon_{t}\)</span> are normally distributed (<span class="math inline">\(\epsilon_{t} \sim N (0, \sigma^{ 2} )\)</span>).</p></li>
</ol>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>If the residuals are independent and identically distributed and normal (<span class="math inline">\(\epsilon_{t} \sim\)</span> i.i.d. <span class="math inline">\(N(0, \sigma^{2}\)</span>)), then all three above properties are automatically satisfied. In this case, <span class="math inline">\(\epsilon_{t}\)</span> are not only uncorrelated but are independent. To be independent is a much stronger property than to be uncorrelated.</p>
</div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>While a given model may still have useful predictive value even when the OLS assumptions are violated, the confidence intervals, prediction intervals, and <span class="math inline">\(p\)</span>-values associated with the <span class="math inline">\(t\)</span>-statistics will generally be incorrect when the OLS assumptions do not hold.</p>
</div>
</div>
<p>A basic technique for investigating the aptness of a regression model is based on analyzing the residuals <span class="math inline">\(\epsilon_{t}\)</span>. In a residual analysis, we attempt to assess the validity of the OLS assumptions by examining the estimated residuals <span class="math inline">\(\hat{\epsilon}_{1}, \dots, \hat{\epsilon}_{n}\)</span> to see if they satisfy the imposed conditions. If the model is apt, the observed residuals should reflect the assumptions listed above.</p>
<p>We perform our diagnostics analysis from a step-by-step verification of each assumption. We start with visual diagnostics, then proceed with formal tests. A lot of useful diagnostic information may be obtained from a residual plot.</p>
<section id="homoskedasticity" class="level3" data-number="1.1.1"><h3 data-number="1.1.1" class="anchored" data-anchor-id="homoskedasticity">
<span class="header-section-number">1.1.1</span> Homoskedasticity</h3>
<p>We plot the residuals <span class="math inline">\(\hat{\epsilon}_{t}\)</span> vs.&nbsp;time, fitted values <span class="math inline">\(\hat{Y}_{t}\)</span>, and predictor values <span class="math inline">\(X_t\)</span>. If the assumption of constant variance is satisfied, <span class="math inline">\(\hat{\epsilon}_{t}\)</span> fluctuate around the zero mean with more or less constant amplitude and this amplitude does not change with time, fitted values <span class="math inline">\(\hat{Y}_{t}\)</span>, and predictor values <span class="math inline">\(X_t\)</span>.</p>
<p>If the (linear) model is not appropriate, the mean of the residuals may be non-constant, i.e., not always 0. <a href="#fig-IdealResiduals">Figure&nbsp;<span>1.1</span></a> shows an example of a random pattern that we would like the residuals to have (no systematic patterns).</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">=</span> <span class="fl">26</span>; <span class="va">m</span> <span class="op">=</span> <span class="fl">0</span>; <span class="va">s</span> <span class="op">=</span> <span class="fl">522</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span>, mean <span class="op">=</span> <span class="va">m</span>, sd <span class="op">=</span> <span class="va">s</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">forecast</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-IdealResiduals" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="l01_regression_files/figure-html/fig-IdealResiduals-1.png" class="img-fluid figure-img" width="768"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;1.1: A time series plot of ‘ideal’ residuals. These residuals <span class="math inline">\(x_t\)</span> are simulated i.i.d. normal.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>What can we notice in a residual plot?</p>
<ul>
<li>Change of variability with time indicates heterogeneity of variance of the residuals.</li>
<li>Obvious lack of symmetry (around 0) in the plot suggests a lack of normality or presence of outliers.</li>
<li>Systematic trends in the residuals suggest correlations between the residuals or inadequateness of the proposed model.</li>
</ul>
<p>Sometimes it is possible to transform the dependent or independent variables to remedy these problems, i.e., to get rid of the correlated residuals or to stabilize the variance (see <a href="s1_wls.html"><span>Appendix&nbsp;A</span></a> and <a href="s2_gls.html"><span>Appendix&nbsp;B</span></a>). Otherwise, we need to change (re-specify) the model.</p>
<p>A useful technique that can guide us in this process is to plot <span class="math inline">\(\hat{\epsilon}_{t}\)</span> vs.&nbsp;<span class="math inline">\(\hat{Y}_{t}\)</span> and <span class="math inline">\(\hat{\epsilon}_{t}\)</span> vs.&nbsp;each predictor <span class="math inline">\(X_t\)</span>. Similarly to their time series plot, <span class="math inline">\(\hat{\epsilon}_{t}\)</span> should fluctuate around the zero mean with more or less constant amplitude.</p>
<div class="callout-note callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Example: Dishwasher shipments model and patterns in residuals
</div>
</div>
<div class="callout-body-container callout-body">
<p><a href="#fig-DishResiduals">Figure&nbsp;<span>1.2</span></a> shows the R code and residuals of a simple linear regression exploring dishwasher shipments (DISH) and private residential investments (RES) for several years.</p>
<p>How different are the patterns in <a href="#fig-DishResiduals">Figure&nbsp;<span>1.2</span></a> from those in <a href="#fig-IdealResiduals">Figure&nbsp;<span>1.1</span></a>?</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">D</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.delim</a></span><span class="op">(</span><span class="st">"data/dish.txt"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">rename</span><span class="op">(</span>Year <span class="op">=</span> <span class="va">YEAR</span><span class="op">)</span></span>
<span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">DISH</span> <span class="op">~</span> <span class="va">RES</span>, data <span class="op">=</span> <span class="va">D</span><span class="op">)</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">D</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Year</span>, y <span class="op">=</span> <span class="va">mod1</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">ylab</span><span class="op">(</span><span class="st">"Residuals"</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">D</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">mod1</span><span class="op">$</span><span class="va">fitted.values</span>, y <span class="op">=</span> <span class="va">mod1</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">xlab</span><span class="op">(</span><span class="st">"Fitted values"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ylab</span><span class="op">(</span><span class="st">"Residuals"</span><span class="op">)</span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">D</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">RES</span>, y <span class="op">=</span> <span class="va">mod1</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">xlab</span><span class="op">(</span><span class="st">"Residential investments (RES)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ylab</span><span class="op">(</span><span class="st">"Residuals"</span><span class="op">)</span></span>
<span><span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span> <span class="va">p3</span> <span class="op">+</span></span>
<span>    <span class="fu">plot_annotation</span><span class="op">(</span>tag_levels <span class="op">=</span> <span class="st">'A'</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-DishResiduals" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="l01_regression_files/figure-html/fig-DishResiduals-1.png" class="img-fluid figure-img" width="768"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;1.2: Estimated residuals plotted vs.&nbsp;time, fitted values, and predictor.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section><section id="uncorrelatedness" class="level3" data-number="1.1.2"><h3 data-number="1.1.2" class="anchored" data-anchor-id="uncorrelatedness">
<span class="header-section-number">1.1.2</span> Uncorrelatedness</h3>
<p>It is a deep topic that we shall discuss many times in different variations in the future. When observations are obtained in a time sequence (the topic of time series analysis and our course), there is a <em>high</em> possibility that the errors <span class="math inline">\(\epsilon_{t}\)</span> are correlated. For instance, if the residual is positive (or negative) for a given day <span class="math inline">\(t\)</span>, it is likely that the residual for the following day <span class="math inline">\(t+1\)</span> is also positive (or negative). Such residuals are said to be <em>autocorrelated</em> (i.e., serially correlated). Autocorrelation of many environmental time series is positive.</p>
<p>When the residuals <span class="math inline">\(\epsilon_{t}\)</span> are related over time, a model for the residuals frequently employed is the first-order autoregressive model, i.e., the AR(1) model.</p>
<p>The <em>autoregressive model of the first order</em>, AR(1), is defined as <span class="math display">\[
\epsilon_{t} = \rho \epsilon_{t - 1} + u_{t},
\]</span> where <span class="math inline">\(\rho\)</span> is the autoregression coefficient (<span class="math inline">\(- 1 &lt; \rho &lt; 1\)</span>) and <span class="math inline">\(u_{t}\)</span> is an uncorrelated <span class="math inline">\(N (0, \sigma^{2})\)</span> time series.</p>
<p>The model assumes that the residual <span class="math inline">\(\epsilon_{t}\)</span> at the time <span class="math inline">\(t\)</span> contains a component resulting from the residual <span class="math inline">\(\epsilon_{t - 1}\)</span> at the time <span class="math inline">\(t - 1\)</span> and a random disturbance <span class="math inline">\(u_{t}\)</span> that is independent of the earlier periods.</p>
<p><strong>Effects of autocorrelation</strong></p>
<p>If the OLS method is employed for the parameter estimation and the residuals <span class="math inline">\(\epsilon_{t}\)</span> are autocorrelated of the first order, then the consequences are:</p>
<ul>
<li>The OLS estimators will still be unbiased, but they no longer have the minimum variance property (see the Gauss–Markov theorem); they tend to be relatively inefficient.</li>
<li>The residual mean square error (MSE) can seriously underestimate the true variance of the error terms in the model.</li>
<li>Standard procedures for CI, PI, and tests using the <span class="math inline">\(F\)</span> and Student’s <span class="math inline">\(t\)</span> distributions are no longer strictly applicable.</li>
</ul>
<p>For example, see Section 5.2 in <span class="citation" data-cites="Chatterjee:Simonoff:2013">Chatterjee and Simonoff (<a href="references.html#ref-Chatterjee:Simonoff:2013" role="doc-biblioref">2013</a>)</span> for more details.</p>
<p><strong>Durbin–Watson test</strong></p>
<p>A widely used test for examining whether the residuals in a regression model are correlated is the Durbin–Watson test. This test is based on the AR(1) model for <span class="math inline">\(\epsilon_{t}\)</span>. The one-tail test alternatives are <span class="math display">\[
\begin{align}
H_{0}{:} ~ \rho = 0 &amp; ~~ vs. ~~ H_{1}{:} ~ \rho &gt; 0,\\
H_{0}{:} ~ \rho = 0 &amp; ~~ vs. ~~ H_{1}{:} ~ \rho &lt; 0,
\end{align}
\]</span> and the two-tail test is <span class="math display">\[
H_{0}{:} ~ \rho = 0 ~~ vs. ~~ H_{1}{:} ~ \rho \neq 0.\\
\]</span></p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>When dealing with real data, positive autocorrelation is usually the case.</p>
</div>
</div>
<p>The Durbin–Watson test statistic DW is based on the differences between the adjacent residuals, <span class="math inline">\(\epsilon_{t} - \epsilon_{t - 1}\)</span>, and is of the following form: <span class="math display">\[
\text{DW} = \frac{\sum^{n}_{t = 2} \left( \epsilon_{t} - \epsilon_{t - 1} \right)^{2}}{\sum^{n}_{t = 1} \epsilon^{2}_{t}},
\]</span> where <span class="math inline">\(\epsilon_{t}\)</span> is the regression residual at the time <span class="math inline">\(t\)</span> and <span class="math inline">\(n\)</span> is the number of observations.</p>
<p>The DW statistic takes on values in the range <span class="math inline">\([0, 4]\)</span>. In fact,</p>
<ul>
<li>When <span class="math inline">\(\epsilon_{t}\)</span> are positively correlated, adjacent residuals tend to be of similar magnitude so that the numerator of DW will be relatively small or 0.</li>
<li>When <span class="math inline">\(\epsilon_{t}\)</span> are negatively correlated, adjacent residuals tend to be of similar magnitude but with the opposite sign so that the numerator of DW will be relatively large or equal to 4.</li>
</ul>
<p>Hence, low DW corresponds to positive autocorrelation. Values of DW that tend towards 4 are in the region for negative autocorrelation.</p>
<p>The exact action limit for the Durbin–Watson test is difficult to calculate. Hence, the test is used with a lower bound <span class="math inline">\(d_{L}\)</span> and an upper bound <span class="math inline">\(d_{U}\)</span>. We may use <a href="#tbl-DW">Table&nbsp;<span>1.1</span></a> as a rule of thumb.</p>
<div id="tbl-DW" class="anchored">
<table class="table">
<caption>Table&nbsp;1.1: Regions of rejection of the null hypothesis for the Durbin–Watson test</caption>
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead><tr class="header">
<th>from 0 to <span class="math inline">\(d_{L}\)</span>
</th>
<th>from <span class="math inline">\(d_{L}\)</span> to <span class="math inline">\(d_{U}\)</span>
</th>
<th>from <span class="math inline">\(d_{U}\)</span> to <span class="math inline">\(4 - d_{U}\)</span>
</th>
<th>from <span class="math inline">\(4 - d_{U}\)</span> to <span class="math inline">\(4 - d_{L}\)</span>
</th>
<th>from <span class="math inline">\(4 - d_{L}\)</span> to 4</th>
</tr></thead>
<tbody><tr class="odd">
<td>Reject <span class="math inline">\(H_{0}\)</span>, positive autocorrelation</td>
<td>Neither accept <span class="math inline">\(H_{1}\)</span> or reject <span class="math inline">\(H_{0}\)</span>
</td>
<td>Do not reject <span class="math inline">\(H_{0}\)</span>
</td>
<td>Neither accept <span class="math inline">\(H_{1}\)</span> or reject <span class="math inline">\(H_{0}\)</span>
</td>
<td>Reject <span class="math inline">\(H_{0}\)</span>, negative autocorrelation</td>
</tr></tbody>
</table>
</div>
<p>The critical values <span class="math inline">\(d_{L}\)</span> and <span class="math inline">\(d_{U}\)</span> have been tabulated for combinations of various sample sizes, significance levels, and number of regressors in a model. For large samples, a normal approximation can be used <span class="citation" data-cites="Chatterjee:Simonoff:2013">(<a href="references.html#ref-Chatterjee:Simonoff:2013" role="doc-biblioref">Chatterjee and Simonoff 2013</a>)</span>: <span class="math display">\[
z = \left(\frac{\text{DW}}{2} - 1 \right)\sqrt{n}.
\]</span> Statistical software packages usually provide exact <span class="math inline">\(p\)</span>-values based on the null distribution of the test statistic (a linear combination of <span class="math inline">\(\chi^2\)</span> variables).</p>
<div class="callout-note callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Example: Dishwasher residuals DW test
</div>
</div>
<div class="callout-body-container callout-body">
<p>Apply the Durbin–Watson test to the residuals from the dishwashers example, i.e., <code>DISH</code> vs.&nbsp;<code>RES</code>, using the R package <code>lmtest</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">lmtest</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/dwtest.html">dwtest</a></span><span class="op">(</span><span class="va">D</span><span class="op">$</span><span class="va">DISH</span> <span class="op">~</span> <span class="va">D</span><span class="op">$</span><span class="va">RES</span>, alternative <span class="op">=</span> <span class="st">"greater"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Durbin-Watson test
#&gt; 
#&gt; data:  D$DISH ~ D$RES
#&gt; DW = 0.6, p-value = 3e-06
#&gt; alternative hypothesis: true autocorrelation is greater than 0</code></pre>
</div>
</div>
<p>Based on the low <span class="math inline">\(p\)</span>-value we can reject the <span class="math inline">\(H_{0}\)</span>: <span class="math inline">\(\rho = 0\)</span> at the 95% confidence level and accept the alternative <span class="math inline">\(H_{1}\)</span>: <span class="math inline">\(\rho &gt; 0\)</span>.</p>
</div>
</div>
<p><strong>Runs test</strong></p>
<p>Departures of randomness can take so many forms that no single test for randomness is best for all situations. For instance, one of the most common departures from randomness is the tendency of a sequence to persist in its direction of movement.</p>
<p>We can count the number of times a sequence of observations crossed a cut-off line, for example, the median line, and use this information to assess the randomness of <span class="math inline">\(\epsilon_t\)</span>. Alternatively, we count successions of positive or negative differences (see <a href="#sec-diffsign"><span>Section&nbsp;1.4</span></a> on the difference sign test). Each such succession is called a <em>run</em>.</p>
<p>The formal test is the following. When a sequence of <span class="math inline">\(N\)</span> observations with <span class="math inline">\(n\)</span> observations in positive runs and <span class="math inline">\(m\)</span> observations in negative runs is a random process with independent values generated from a continuous distribution, then the sampling distribution of the number of runs <span class="math inline">\(R\)</span> has the mean and variance <span class="math display">\[
\mathrm{E}(R) = \frac{1 + 2nm}{N}, \qquad \sigma^2(R) = \frac{2nm(2nm-n-m)}{N^2(N-1)},
\]</span> where <span class="math inline">\(N = n + m\)</span> is the total sample size.</p>
<p>The only assumption for this test is that all sample observations come from a continuous distribution.</p>
<p>The two-tail alternative is as follows</p>
<ul>
<li>
<span class="math inline">\(H_{0}\)</span>: Sequence is generated by a random process;</li>
<li>
<span class="math inline">\(H_{1}\)</span>: Sequence is generated by a process containing either persistence or frequent changes in direction.</li>
</ul>
<p>When positive autocorrelation (or persistence) is present, <span class="math inline">\(R\)</span> will be small. On the other hand, if the process involves frequent changes in direction (negative autocorrelation or anti-persistence), <span class="math inline">\(R\)</span> will be too large.</p>
<p>When the number of observations is sufficiently large, i.e., <span class="math inline">\(N &gt; 30\)</span>, the runs test statistic <span class="math inline">\(R\)</span> is based on the standardized normal test statistic <span class="math display">\[
z = \frac{R - \mathrm{E}(R)}{ \sigma(R)}.
\]</span> Here <span class="math inline">\(z\)</span> follows approximately a standard normal distribution.</p>
<p>Runs test is easy to interpret. Runs test allows assessing only the first-order serial correlation in the residuals, i.e., to test whether two residuals that are one lag apart are correlated.</p>
<div class="callout-note callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Example: Dishwasher residuals runs test
</div>
</div>
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">lawstat</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lawstat/man/runs.test.html">runs.test</a></span><span class="op">(</span><span class="va">x</span>, plot.it <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Runs Test - Two sided
#&gt; 
#&gt; data:  x
#&gt; Standardized Runs Statistic = -0.4, p-value = 0.7</code></pre>
</div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">lawstat</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lawstat/man/runs.test.html">runs.test</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">$</span><span class="va">residuals</span>, plot.it <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Runs Test - Two sided
#&gt; 
#&gt; data:  mod1$residuals
#&gt; Standardized Runs Statistic = -3, p-value = 0.005</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-Runs" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="l01_regression_files/figure-html/fig-Runs-1.png" class="img-fluid figure-img" width="768"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;1.3: Runs tests and plots of independent normally distributed simulations <span class="math inline">\(x_t\)</span> and the <code>DISH</code> residuals.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>The <span class="math inline">\(p\)</span>-value for the runs test for the residuals is very low (<a href="#fig-Runs">Figure&nbsp;<span>1.3</span></a>), which supports the findings of the DW test that residuals are first-order serially correlated.</p>
</div>
</div>
</section><section id="normality" class="level3" data-number="1.1.3"><h3 data-number="1.1.3" class="anchored" data-anchor-id="normality">
<span class="header-section-number">1.1.3</span> Normality</h3>
<p>There are two major ways of checking normality. Graphical methods visualize differences between empirical data and theoretical normal distribution. Numerical methods conduct statistical tests on the null hypothesis that the variable is normally distributed.</p>
<section id="graphical-methods" class="level4" data-number="1.1.3.1"><h4 data-number="1.1.3.1" class="anchored" data-anchor-id="graphical-methods">
<span class="header-section-number">1.1.3.1</span> Graphical methods</h4>
<p>Graphical methods visualize the data using graphs, such as histograms, stem-and-leaf plots, box plots, etc. For example, <a href="#fig-Histograms">Figure&nbsp;<span>1.4</span></a> shows a histogram of the simulated normally distributed data and the residuals from the dishwasher example with superimposed normal curves with the corresponding mean and standard deviation.</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span><span class="op">)</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">geom_histogram</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="fu">after_stat</span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="fl">300</span>, fill <span class="op">=</span> <span class="st">"grey50"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">stat_function</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dnorm</span>, </span>
<span>                  args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                  col <span class="op">=</span> <span class="fl">1</span>, lwd <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ylab</span><span class="op">(</span><span class="st">"Density"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Random normal values"</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">x</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">mod1</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">geom_histogram</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="fu">after_stat</span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="fl">300</span>, fill <span class="op">=</span> <span class="st">"grey50"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">stat_function</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dnorm</span>, </span>
<span>                  args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span>, sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                  col <span class="op">=</span> <span class="fl">1</span>, lwd <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ylab</span><span class="op">(</span><span class="st">"Density"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Model residuals"</span><span class="op">)</span></span>
<span><span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span></span>
<span>    <span class="fu">plot_annotation</span><span class="op">(</span>tag_levels <span class="op">=</span> <span class="st">'A'</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-Histograms" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="l01_regression_files/figure-html/fig-Histograms-1.png" class="img-fluid figure-img" width="768"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;1.4: Histograms of the simulated normally distributed values and estimated regression residuals.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Another very popular graphical method of assessing normality is the quantile-quantile (Q-Q) plot. The Q-Q plot compares the ordered values of a variable with the corresponding ordered values of the normal distribution.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Q-Q plots can also be used to compare sample quantiles with quantiles of other, not normal, distribution (e.g., <span class="math inline">\(t\)</span> or gamma distribution), or to compare quantiles of two samples (to assess if both samples come from the same, unspecified, distribution).</p>
</div>
</div>
<p>Let <span class="math inline">\(X\)</span> be a random variable having the property that the equation <span class="math display">\[
\Pr \left( X \leqslant x \right) = \alpha
\]</span> has a unique solution <span class="math inline">\(x = x_{(\alpha)}\)</span> for each <span class="math inline">\(0 &lt; \alpha &lt; 1\)</span>. That is, there exists <span class="math inline">\(x_{(\alpha)}\)</span> such that <span id="eq-prob"><span class="math display">\[
\Pr \left( X \leqslant x_{(\alpha)} \right) = \alpha
\tag{1.1}\]</span></span> and no other value of <span class="math inline">\(x\)</span> satisfies <a href="#eq-prob">Equation&nbsp;<span>1.1</span></a>. Then we will call <span class="math inline">\(x_{(\alpha)}\)</span> the <span class="math inline">\(\alpha\)</span>th <em>(population) quantile</em> of <span class="math inline">\(X\)</span>. Note that any normal distribution has this uniqueness property. If we consider a standard normal <span class="math inline">\(Z \sim N(0, 1)\)</span>, then some well-known quantiles are:</p>
<ul>
<li>
<span class="math inline">\(z_{(0.5)} = 0\)</span> (the median), <code>qnorm(0.5, mean = 0, sd = 1)</code>
</li>
<li>
<span class="math inline">\(z_{(0.05)} = -1.645\)</span> and <span class="math inline">\(z_{(0.95)} = 1.645\)</span>
</li>
<li>
<span class="math inline">\(z_{(0.025)} = -1.96\)</span> and <span class="math inline">\(z_{(0.975)} = 1.96\)</span>
</li>
</ul>
<p>We call the 0.25th, 0.5th, 0.75th quantiles the first, the second, and the third quartiles, respectively. The quartiles divide our data into 4 equal parts.</p>
<p>Now suppose <span class="math inline">\(X \sim N (\mu, \sigma^{2})\)</span>. By standardizing to <span class="math inline">\(Z \sim N(0, 1)\)</span>, we obtain <span class="math display">\[
\alpha = \Pr \left( X \leqslant x_{(\alpha)} \right) = \Pr \left( \frac{X - \mu}{ \sigma} \leqslant \frac{x_{(\alpha)} - \mu}{\sigma} \right) = \Pr \left( Z \leqslant \frac{x_{(\alpha)} - \mu}{ \sigma} \right) .
\]</span></p>
<p>We also have <span class="math inline">\(\alpha = \Pr (Z \leqslant z_{(\alpha)} )\)</span> by definition. It follows that <span class="math display">\[
z_{(\alpha)} = \frac{x_{(\alpha)} - \mu}{ \sigma} ~~~~ \mbox{and hence} ~~~~ x_{(\alpha)} = \sigma z_{(\alpha)} + \mu.
\]</span></p>
<p>Thus, if <span class="math inline">\(X\)</span> is truly normal, a plot of the quantiles of <span class="math inline">\(X\)</span> vs.&nbsp;the quantiles of the standard normal distribution should yield a straight line. A plot of the quantiles of <span class="math inline">\(X\)</span> vs.&nbsp;the quantiles of <span class="math inline">\(Z\)</span> is called a Q-Q plot.</p>
<p><strong>Estimating quantiles from data</strong></p>
<p>Let <span class="math inline">\(X_{1}, \dots, X_{n}\)</span> be a sequence of observations. Ideally, <span class="math inline">\(X_{1}, \dots, X_{n}\)</span> should represent i.i.d. observations but we will be happy if preliminary tests indicate that they are homoskedastic and uncorrelated (see the previous sections). We order them from the smallest to the largest and indicate this using the notation <span class="math display">\[
X_{(1/n)} &lt; X_{(2/n)} &lt; X_{(3/n)} &lt; \dots &lt; X_{\left((n - 1)/n\right)} &lt; X_{(n/n)}.
\]</span></p>
<p>The above ordering assumes no ties, but ties can be quite common in data, even continuous data, because of rounding. As long as the proportion of ties is small, this method can be used.</p>
<p>Note that the proportion of observations less than or equal to <span class="math inline">\(X_{(k/n)}\)</span> is exactly <span class="math inline">\(k/n\)</span>. Hence <span class="math inline">\(X_{(k/n)}\)</span>, called the <span class="math inline">\(k\)</span>th <em>sample quantile</em>, is an estimate of the population quantile <span class="math inline">\(x_{(k/n)}\)</span>.</p>
<p>The normal Q-Q plot is obtained by plotting the sample quantiles vs.&nbsp;the quantiles of the standard normal distribution. The base-R function <code><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm()</a></code> produces a normal Q-Q plot of data and the function <code><a href="https://rdrr.io/r/stats/qqnorm.html">qqline()</a></code> adds a line that passes through the first and third quartiles. The R package <code>ggplot2</code> has analogous functions <code><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html">ggplot2::stat_qq()</a></code> and <code><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html">ggplot2::stat_qq_line()</a></code>. The R packages <code>car</code> and <code>ggpubr</code> also draw Q-Q plots, but also add a point-wise confidence envelope with their functions <code><a href="https://rdrr.io/pkg/car/man/qqPlot.html">car::qqPlot()</a></code> (base-R plot) and <code><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggqqplot.html">ggpubr::ggqqplot()</a></code> (ggplot-type plot).</p>
<div class="callout-note callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Example: Dishwasher residuals normal Q-Q plot
</div>
</div>
<div class="callout-body-container callout-body">
<p><a href="#fig-QQ">Figure&nbsp;<span>1.5</span></a> shows the Q-Q plots of the residuals from the dishwasher example and the simulated normal data with the same mean and standard deviation.</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">ggpubr</span><span class="fu">::</span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggqqplot.html">ggqqplot</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Random normal values"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">xlab</span><span class="op">(</span><span class="st">"Standard normal quantiles"</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">ggpubr</span><span class="fu">::</span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggqqplot.html">ggqqplot</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Model residuals"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">xlab</span><span class="op">(</span><span class="st">"Standard normal quantiles"</span><span class="op">)</span></span>
<span><span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span></span>
<span>    <span class="fu">plot_annotation</span><span class="op">(</span>tag_levels <span class="op">=</span> <span class="st">'A'</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-QQ" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="l01_regression_files/figure-html/fig-QQ-1.png" class="img-fluid figure-img" width="768"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;1.5: Normal Q-Q plots of the normally distributed simulated values <span class="math inline">\(x_t\)</span> and the dishwasher residuals.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<p>Although visually appealing, these graphical methods do not provide objective criteria to determine the normality of variables.</p>
<p><strong>Shapiro–Wilk normality test</strong></p>
<p>One of the most popular numerical methods for assessing normality is the Shapiro–Wilk (SW) test:</p>
<ul>
<li>
<span class="math inline">\(H_0\)</span>: the sample data come from a normally distributed population;</li>
<li>
<span class="math inline">\(H_1\)</span>: the population is not normally distributed).</li>
</ul>
<p>The SW test is the ratio of the best estimator of the variance to the usual corrected sum of squares estimator of the variance. It has been originally constructed by considering the regression of ordered sample values on corresponding expected normal order statistics. The SW statistic is given by <span class="math display">\[
\mbox{SW} = \frac{\left(\sum a_{i} x_{(i)} \right)^{2}}{\sum \left(x_{i} - \bar{x} \right)^{2}},
\]</span> where <span class="math inline">\(x_{(i)}\)</span> are the ordered sample values (<span class="math inline">\(x_{(1)}\)</span> is the smallest) and the <span class="math inline">\(a_{i}\)</span> are constants generated from the means, variances, and covariances of the order statistics of a sample of size <span class="math inline">\(n\)</span> from a normal distribution. The SW statistic lies between 0 and 1. If the SW statistic is close to 1, this indicates the normality of the data. The SW statistic requires the sample size <span class="math inline">\(n\)</span> to be between 7 and 2000.</p>
<div class="callout-note callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Example: Dishwasher residuals normality test
</div>
</div>
<div class="callout-body-container callout-body">
<p>Based on the <span class="math inline">\(p\)</span>-values below, we cannot reject the null hypothesis of normality in both cases.</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Shapiro-Wilk normality test
#&gt; 
#&gt; data:  x
#&gt; W = 0.9, p-value = 0.08</code></pre>
</div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Shapiro-Wilk normality test
#&gt; 
#&gt; data:  mod1$residuals
#&gt; W = 1, p-value = 0.8</code></pre>
</div>
</div>
</div>
</div>
</section></section><section id="summary-of-the-simple-linear-regression-residual-diagnostics" class="level3" data-number="1.1.4"><h3 data-number="1.1.4" class="anchored" data-anchor-id="summary-of-the-simple-linear-regression-residual-diagnostics">
<span class="header-section-number">1.1.4</span> Summary of the simple linear regression residual diagnostics</h3>
<ol type="1">
<li>The residuals do not have a constant mean.</li>
<li>The residuals seem to have a constant variance.</li>
<li>The residuals are positively correlated.</li>
<li>The residuals look normally distributed (but the SW statistic might be affected by the serial correlation of the residuals).</li>
</ol></section></section><section id="multiple-linear-regression" class="level2" data-number="1.2"><h2 data-number="1.2" class="anchored" data-anchor-id="multiple-linear-regression">
<span class="header-section-number">1.2</span> Multiple linear regression</h2>
<p>Here we consider a case of <span class="math inline">\(p\)</span> explanatory variables <span class="math display">\[
Y_{t} = \beta_{0} + \beta_{1} X_{t,1} + \dots + \beta_{p} X_{t,p} + \epsilon_{t} \quad (t = 1,\dots,n).
\]</span></p>
<p>This can be expressed more compactly in a matrix notation as <span class="math display">\[
\boldsymbol{Y} = \boldsymbol{X} \boldsymbol{\beta} + \boldsymbol{\epsilon},
\]</span> where <span class="math inline">\(\boldsymbol{Y} = (Y_{1}, \dots, Y_{n})^{\top}\)</span>, <span class="math inline">\(\boldsymbol{\beta} = (\beta_{0} , \dots, \beta_{p})^{\top}\)</span>, <span class="math inline">\(\boldsymbol{\epsilon} = (\epsilon_{1} , \dots, \epsilon_{n})^{\top}\)</span>; <span class="math inline">\(\boldsymbol{X}\)</span> is an <span class="math inline">\(n \times (p + 1)\)</span> design matrix <span class="math display">\[
\boldsymbol{X} = \left(
\begin{array}{cccc}
1 &amp; X_{1,1} &amp; \dots &amp; X_{1,p} \\
1 &amp; X_{2,1}&amp; \dots &amp; X_{2,p} \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
1 &amp; X_{n,1}&amp; \dots &amp; X_{n,p}
\end{array}
\right).
\]</span></p>
<p>Here the historical dataset for the dependent variable consists of the observations <span class="math inline">\(Y_{1}, \dots, Y_{n}\)</span>; the historical dataset for the independent variables consists of the observations in the matrix <span class="math inline">\(\boldsymbol{X}\)</span>.</p>
<p>Minimizing <span class="math inline">\(SSE =(\boldsymbol{Y} - \boldsymbol{X} \hat{\boldsymbol{\beta}})^{\top} (\boldsymbol{Y} - \boldsymbol{X} \hat{\boldsymbol{\beta}})\)</span> yields the least squares solutions <span class="math display">\[
\hat{\boldsymbol{\beta}} = \left( \boldsymbol{X}^{\top} \boldsymbol{X} \right)^{-1} \boldsymbol{X}^{\top} \boldsymbol{Y}
\]</span> for non-singular <span class="math inline">\(\boldsymbol{X}^{\top}\boldsymbol{X}\)</span>.</p>
<p>The forecast of a future value <span class="math inline">\(Y_{t}\)</span> is then given by <span class="math display">\[
\hat{Y}_{t} = \boldsymbol{x}^{\top}_{t} \hat{\boldsymbol{\beta}},
\]</span> where <span class="math inline">\(\boldsymbol{x}_{t}\)</span> is a (column) vector at the time <span class="math inline">\(t\)</span>.</p>
<p>Under the OLS assumptions (recall them), we obtain <span class="math display">\[
\mathrm{var} \left( \hat{\beta}_{j} \right) = \sigma^{2} \left( \boldsymbol{X }^{\top} \boldsymbol{X} \right)^{-1}_{jj},
\]</span> where the <span class="math inline">\(\left( \boldsymbol{X}^{\top} \boldsymbol{X} \right)^{-1}_{jj}\)</span> denotes the <span class="math inline">\(j\)</span>th diagonal element of <span class="math inline">\(\left( \boldsymbol{X }^{\top} \boldsymbol{X} \right)^{-1}\)</span>.</p>
<p>This yields <span class="math display">\[
s.e. \left( \hat{\beta}_{j} \right) = \hat{\sigma} \sqrt{ \left( \boldsymbol{X }^{\top} \boldsymbol{X} \right)^{-1}_{jj}}.
\]</span></p>
<p>Note that here the degrees of freedom (d.f.)&nbsp;are <span class="math inline">\(n - (p + 1) = n - p - 1\)</span>. (The number of estimated parameters for the independent variables is <span class="math inline">\(p\)</span>, plus one for the intercept, i.e., <span class="math inline">\(p + 1\)</span>.)</p>
<p>Under the OLS assumptions, a <span class="math inline">\(100(1 - \alpha)\)</span>% confidence interval for the parameter <span class="math inline">\(\beta_{j}\)</span> (<span class="math inline">\(j = 0, 1, \dots, p\)</span>) is given by <span id="eq-betaCI"><span class="math display">\[
\begin{split}
\hat{\beta}_{j} &amp;\pm t_{\alpha / 2, n - (p+1)} s.e.\left( \hat{\beta}_{j} \right) \text{ or} \\
\hat{\beta}_{j} &amp;\pm t_{\alpha / 2, n - (p+1)} \hat{\sigma} \sqrt{\left( \boldsymbol{X}^{\top} \boldsymbol{X} \right)^{-1}_{jj}}.
\end{split}
\tag{1.2}\]</span></span></p>
<p>Typically, <span class="math inline">\(s.e.(\hat{\beta}_{j})\)</span> is available directly from the R output, so <a href="#eq-betaCI">Equation&nbsp;<span>1.2</span></a> is calculated automatically.</p>
<p>Under the OLS assumptions, it can be shown that <span class="math display">\[
\mathrm{var} \left( Y_{t} - \hat{Y}_{t} \right) = \sigma^{2} \left( \boldsymbol{x}^{\top}_{t} \left( \boldsymbol{X}^{\top} \boldsymbol{X} \right)^{- 1} \boldsymbol{x}_{t} + 1 \right),
\]</span> yielding a <span class="math inline">\(100(1 - \alpha)\)</span>% prediction interval for <span class="math inline">\(Y_{t}\)</span>: <span class="math display">\[
\boldsymbol{x}^{\top}_{t} \hat{\boldsymbol{\beta}} \pm t_{\alpha / 2, n-(p+1)} \hat{\sigma} \sqrt{ \boldsymbol{x}^{\top}_{t} \left( \boldsymbol{X}^{\top} \boldsymbol{X} \right)^{-1}\boldsymbol{x}_{t} + 1}.
\]</span></p>
<p>We usually never perform these calculations by hand and will use the corresponding software functions, e.g., using the function <code><a href="https://rdrr.io/r/stats/predict.html">predict()</a></code>, see an example code below.</p>
<p><strong>What else can we get from the regression output?</strong></p>
<p>As in SLR, we will look for the <span class="math inline">\(t\)</span>-statistics and <span class="math inline">\(p\)</span>-values to get an idea about the statistical significance of each of the predictors <span class="math inline">\(X_{t,1}, X_{t,2}, \dots, X_{t,p}\)</span>. The confidence intervals constructed above correspond to individual tests of hypothesis about a parameter, i.e., <span class="math inline">\(H_{0}\)</span>: <span class="math inline">\(\beta_{j} = 0\)</span> vs.&nbsp;<span class="math inline">\(H_{1}\)</span>: <span class="math inline">\(\beta_{j} \neq 0\)</span>.</p>
<p>We can also make use of the <span class="math inline">\(F\)</span>-test. The <span class="math inline">\(F\)</span>-test considers <em>all</em> parameters (other than the intercept <span class="math inline">\(\beta_{0}\)</span>) simultaneously, testing <span class="math display">\[
\begin{split}
H_{0}{:} ~ \beta_{1} &amp;= \dots = \beta_{p} = 0 ~~~ \text{vs.} \\
H_{1}{:} ~ \beta_{j} &amp;\neq 0 ~~~ \mbox{for at least one} ~~~ j \in \{1, \dots, p \}.
\end{split}
\]</span></p>
<p>Formally, <span class="math inline">\(F_{\rm{obs}} = \rm{MSR/MSE}\)</span> (the ratio of the mean square due to regression and the mean square due to stochastic errors).</p>
<p>We reject <span class="math inline">\(H_{0}\)</span> when <span class="math inline">\(F_{\rm{obs}}\)</span> is too large relative to a cut-off point determined by the degrees of freedom of the <span class="math inline">\(F\)</span>-distribution. The <span class="math inline">\(p\)</span>-value for this <span class="math inline">\(F\)</span>-test is provided in the <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> output. Rejecting <span class="math inline">\(H_{0}\)</span> is equivalent to stating that the model has some explanatory value within the range of the data set, meaning that changes in at least some of the explanatory <span class="math inline">\(X\)</span>-variables correlate to changes in the average value of <span class="math inline">\(Y\)</span>.</p>
<p>Recall that <span class="math display">\[
\begin{split}
\mathrm{SST} &amp;= \sum_{i=1}^n(Y_t-\overline{Y})^2= \mathrm{SSR} + \mathrm{SSE},\\
\mathrm{SSE} &amp;=\sum_{t=1}^n(Y_t-\hat{\beta}_0 - \hat{\beta}_1 X_{t,1}-\dots- \hat{\beta}_p X_{t,p})
\end{split}
\]</span> and, hence, <span class="math display">\[
\rm{SSR}=\rm{SST}-\rm{SSE}.
\]</span></p>
<p>To conclude that the model has a reasonable fit, however, we would additionally like to see a high <span class="math inline">\(R^{2}\)</span> value, where <span class="math display">\[
R^{2} = \rm{SSR/SST}
\]</span> is the proportion of the total sum of squares explained by the regression.</p>
<p>Small <span class="math inline">\(R^{2}\)</span> means that the stochastic fluctuations around the regression line (or prediction equation) are large, making the prediction task difficult, even though there may be a genuine explanatory relationship between the average value <span class="math inline">\(\mathrm{E}(Y)\)</span> and some of the <span class="math inline">\(X\)</span>-variables.</p>
<p>Another criterion to judge the aptness of the obtained model is the adjusted <span class="math inline">\(R^2\)</span>: <span class="math display">\[
R^2_{adj}=1-\frac{n-1}{n-p}\left( 1-R^2 \right).
\]</span></p>
<p>Unlike <span class="math inline">\(R^2\)</span> itself, <span class="math inline">\(R^2_{adj}\)</span> need not increase if an arbitrary (even useless) predictor is added to the model because of the correction <span class="math inline">\((n-1)/(n-p)\)</span>.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The intercept <span class="math inline">\(\beta_{0}\)</span> is not included in the <span class="math inline">\(F\)</span>-test because there is no explanatory variable associated with it. In other words, <span class="math inline">\(\beta_{0}\)</span> does not contribute to the regression part of the model.</p>
</div>
</div>
<div class="callout-note callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Example: Dishwasher shipments multiple linear regression
</div>
</div>
<div class="callout-body-container callout-body">
<p>Let us now extend the SLR model that we considered previously and include another potential predictor, the durable goods expenditures (billion of 1972 dollars). The goal is to build a model to predict the unit factory shipments of dishwashers (DISH) vs.&nbsp;private residential investment (RES) and durable goods expenditures (DUR) using a multiple linear regression model (MLR): <span class="math display">\[
Y_{t} = \beta_{0} + \beta_{1} X_{t,1} + \beta_{2} X_{t,2} + \epsilon_t,
\]</span> where <span class="math inline">\(X_{t,1}\)</span> is the private residential investment <code>RES</code>; <span class="math inline">\(X_{t,2}\)</span> is the durable goods expenditures <code>DUR</code>.</p>
<p>Now we apply the OLS method to estimate the coefficients <span class="math inline">\(\beta_{0}\)</span>, <span class="math inline">\(\beta_{1}\)</span>, and <span class="math inline">\(\beta_{2}\)</span> using the function <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">DISH</span> <span class="op">~</span> <span class="va">RES</span> <span class="op">+</span> <span class="va">DUR</span>, data <span class="op">=</span> <span class="va">D</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt; Call:
#&gt; lm(formula = DISH ~ RES + DUR, data = D)
#&gt; 
#&gt; Residuals:
#&gt;    Min     1Q Median     3Q    Max 
#&gt; -643.9 -263.2  -22.1  190.2  920.0 
#&gt; 
#&gt; Coefficients:
#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    
#&gt; (Intercept) -1603.09     391.31   -4.10  0.00044 ***
#&gt; RES            50.97      11.37    4.48  0.00017 ***
#&gt; DUR            13.77       2.78    4.95  5.2e-05 ***
#&gt; ---
#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#&gt; 
#&gt; Residual standard error: 378 on 23 degrees of freedom
#&gt; Multiple R-squared:  0.877,  Adjusted R-squared:  0.867 
#&gt; F-statistic: 82.3 on 2 and 23 DF,  p-value: 3.31e-11</code></pre>
</div>
</div>
<p>We have a high <span class="math inline">\(R^2_{adj} =\)</span> 0.867 and both predictors are statistically significant, but can we already wholeheartedly trust these results? We need to perform the residual diagnostics.</p>
<p>Plot the estimated residuals <span class="math inline">\(\hat{\epsilon}_{t} = \hat{Y}_{t} - Y_{t}\)</span> vs.&nbsp;the observed <span class="math inline">\(Y_{t}\)</span> (<span class="math inline">\(t = 1, 2, \dots, 26\)</span> or <code>Year</code>) – see <a href="#fig-DishResiduals2">Figure&nbsp;<span>1.6</span></a>.</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">D</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Year</span>, y <span class="op">=</span> <span class="va">mod2</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">ylab</span><span class="op">(</span><span class="st">"Residuals"</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">D</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">mod2</span><span class="op">$</span><span class="va">fitted.values</span>, y <span class="op">=</span> <span class="va">mod2</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">xlab</span><span class="op">(</span><span class="st">"Fitted values"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ylab</span><span class="op">(</span><span class="st">"Residuals"</span><span class="op">)</span></span>
<span><span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span></span>
<span>    <span class="fu">plot_annotation</span><span class="op">(</span>tag_levels <span class="op">=</span> <span class="st">'A'</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-DishResiduals2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="l01_regression_files/figure-html/fig-DishResiduals2-1.png" class="img-fluid figure-img" width="768"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;1.6: Residuals vs.&nbsp;time and vs.&nbsp;fitted values.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Check that the residuals <span class="math inline">\(\epsilon_{t}\)</span> are uncorrelated (the Durbin–Watson and the runs tests):</p>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">lmtest</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/dwtest.html">dwtest</a></span><span class="op">(</span><span class="va">D</span><span class="op">$</span><span class="va">DISH</span> <span class="op">~</span> <span class="va">D</span><span class="op">$</span><span class="va">RES</span> <span class="op">+</span> <span class="va">D</span><span class="op">$</span><span class="va">DUR</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Durbin-Watson test
#&gt; 
#&gt; data:  D$DISH ~ D$RES + D$DUR
#&gt; DW = 0.4, p-value = 7e-09
#&gt; alternative hypothesis: true autocorrelation is greater than 0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">lawstat</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lawstat/man/runs.test.html">runs.test</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">$</span><span class="va">residuals</span>, plot.it <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Runs Test - Two sided
#&gt; 
#&gt; data:  mod2$residuals
#&gt; Standardized Runs Statistic = -4, p-value = 3e-04</code></pre>
</div>
</div>
<p>Check that the residuals <span class="math inline">\(\epsilon_{t}\)</span> are normally distributed using the Q-Q plot (<a href="#fig-QQ2">Figure&nbsp;<span>1.7</span></a>) and Shapiro–Wilk test.</p>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Shapiro-Wilk normality test
#&gt; 
#&gt; data:  mod2$residuals
#&gt; W = 1, p-value = 0.9</code></pre>
</div>
</div>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggpubr</span><span class="fu">::</span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggqqplot.html">ggqqplot</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">xlab</span><span class="op">(</span><span class="st">"Standard normal quantiles"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-QQ2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="l01_regression_files/figure-html/fig-QQ2-1.png" class="img-fluid figure-img" width="768"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;1.7: Normal Q-Q plot of the multiple regression residuals.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<section id="summary-of-the-multiple-linear-regression-residual-diagnostics" class="level3" data-number="1.2.1"><h3 data-number="1.2.1" class="anchored" data-anchor-id="summary-of-the-multiple-linear-regression-residual-diagnostics">
<span class="header-section-number">1.2.1</span> Summary of the multiple linear regression residual diagnostics</h3>
<ol type="1">
<li>The <span class="math inline">\(R^{2}\)</span> has been improved.</li>
<li>We do not see a visible improvement in terms of the mean and variance of the residuals.</li>
<li>The residuals are still positively correlated.</li>
<li>The residuals look normally distributed.</li>
</ol>
<p>Even though not all OLS assumptions are satisfied we shall consider how to predict the future values of <span class="math inline">\(Y\)</span> and to construct the prediction intervals using R.</p>
<p>For example, assume that we need to predict the future unit factory shipments of dishwashers (<code>DISH</code>) based on the private residential investment of 100 billion USD and durable goods expenditures of 150 billion USD.</p>
<p>Supply new values of independent variables and use the function <code><a href="https://rdrr.io/r/stats/predict.html">predict()</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">newData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>RES <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>, DUR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">150</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">mod2</span>, <span class="va">newData</span>, se.fit <span class="op">=</span> <span class="cn">TRUE</span>, interval <span class="op">=</span> <span class="st">"prediction"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; $fit
#&gt;    fit  lwr  upr
#&gt; 1 5559 4227 6891
#&gt; 
#&gt; $se.fit
#&gt; [1] 521
#&gt; 
#&gt; $df
#&gt; [1] 23
#&gt; 
#&gt; $residual.scale
#&gt; [1] 378</code></pre>
</div>
</div>
</section></section><section id="conclusion" class="level2" data-number="1.3"><h2 data-number="1.3" class="anchored" data-anchor-id="conclusion">
<span class="header-section-number">1.3</span> Conclusion</h2>
<p>We have recalled the standard assumptions about residuals of linear regression models. Remember that there are some other assumptions (e.g., about linear independence of predictors) that must be verified. Refer to the reading materials for a complete list.</p>
<p>The methods we have used to test the homogeneity of residuals included various residual plots. The normality of residuals can be assessed using histograms or Q-Q plots and statistical tests such as the Shapiro–Wilk normality test.</p>
<p>The use of time series in regression presents additional ways to assess patterns in the regression residuals. A plot of residuals vs.&nbsp;time is assessed for homogeneity and absence of trends. Less obvious patterns, such as autocorrelation, can be tested with parametric and nonparametric tests, such as the Durbin–Watson and runs tests.</p>
<p>The statistical techniques we will learn aim to model or extract as much information from time series (including the autocorrelation of regression residuals) as possible, such that the remaining series are completely random.</p>
</section><section id="sec-diffsign" class="level2" data-number="1.4"><h2 data-number="1.4" class="anchored" data-anchor-id="sec-diffsign">
<span class="header-section-number">1.4</span> Appendix</h2>
<p>Alternative versions of the runs test are available, e.g., in the package <code>randtests</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">randtests</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/randtests/man/runs.test.html">runs.test</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Runs Test
#&gt; 
#&gt; data:  mod2$residuals
#&gt; statistic = -4, runs = 5, n1 = 13, n2 = 13, n = 26, p-value = 3e-04
#&gt; alternative hypothesis: nonrandomness</code></pre>
</div>
</div>
<p><strong>Difference sign test</strong></p>
<p>The logic behind the difference sign test is that in a random process, there will be roughly the same number of ups (positive differences between consecutive values, i.e., <span class="math inline">\(X_t-X_{t-1}\)</span>) and downs (negative differences).</p>
<p><span class="citation" data-cites="Brockwell:Davis:2002">Brockwell and Davis (<a href="references.html#ref-Brockwell:Davis:2002" role="doc-biblioref">2002</a>)</span>: “The difference-sign test must be used with caution. A set of observations exhibiting a strong cyclic component will pass the difference-sign test for randomness since roughly half of the observations will be points of increase.” We may see (<a href="#fig-DishResiduals">Figure&nbsp;<span>1.2</span></a> and <a href="#fig-DishResiduals2">Figure&nbsp;<span>1.6</span></a>), it is the case for our residuals, even though we have no cyclic component, but have a rise followed by a decline.</p>
<div class="cell">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">randtests</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/randtests/man/difference.sign.test.html">difference.sign.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Difference Sign Test
#&gt; 
#&gt; data:  x
#&gt; statistic = -2, n = 26, p-value = 0.1
#&gt; alternative hypothesis: nonrandomness</code></pre>
</div>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">randtests</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/randtests/man/difference.sign.test.html">difference.sign.test</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Difference Sign Test
#&gt; 
#&gt; data:  mod1$residuals
#&gt; statistic = 0.3, n = 26, p-value = 0.7
#&gt; alternative hypothesis: nonrandomness</code></pre>
</div>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">randtests</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/randtests/man/difference.sign.test.html">difference.sign.test</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Difference Sign Test
#&gt; 
#&gt; data:  mod2$residuals
#&gt; statistic = -0.3, n = 26, p-value = 0.7
#&gt; alternative hypothesis: nonrandomness</code></pre>
</div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography" style="display: none">
<div id="ref-Brockwell:Davis:2002" class="csl-entry" role="doc-biblioentry">
Brockwell PJ, Davis RA (2002) Introduction to time series and forecasting, 2nd edn. Springer, New York, NY, USA
</div>
<div id="ref-Chatterjee:Hadi:2006" class="csl-entry" role="doc-biblioentry">
Chatterjee S, Hadi AS (2006) Regression analysis by example, 4th edn. John Wiley &amp; Sons, Hoboken, NJ, USA
</div>
<div id="ref-Chatterjee:Simonoff:2013" class="csl-entry" role="doc-biblioentry">
Chatterjee S, Simonoff JS (2013) Handbook of regression analysis. John Wiley &amp; Sons, Hoboken, NJ, USA
</div>
</div>
</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./index.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Preface</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./l02_tsintro.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction to Time Series Analysis</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>